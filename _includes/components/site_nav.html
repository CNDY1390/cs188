{%- comment -%} 
Override Just the Docs components/site_nav.html with language filtering
This file is called by sidebar.html (or default layout) to generate navigation

问题：page.url 在 includes 中不可靠（显示 /404.html），必须使用客户端检测
解决方案：使用客户端 JavaScript 检测语言并过滤导航
{%- endcomment -%}

{%- comment -%} 先渲染所有页面，由客户端 JavaScript 过滤 {%- endcomment -%}
{% include nav.html pages=site.html_pages key=nil %}

{%- comment -%} 客户端语言检测和过滤 {%- endcomment -%}
<script>
(function() {
  var pathname = window.location.pathname;
  var currentLang = 'en';
  if (pathname.includes('/zh-cn/')) {
    currentLang = 'zh-cn';
  } else if (pathname.includes('/es/')) {
    currentLang = 'es';
  }
  
  var navItems = document.querySelectorAll('.nav-list-item');
  navItems.forEach(function(item) {
    var link = item.querySelector('.nav-list-link');
    if (!link) return;
    
    var href = link.getAttribute('href');
    if (!href) return;
    
    var itemLang = 'en';
    if (href.includes('/zh-cn/')) {
      itemLang = 'zh-cn';
    } else if (href.includes('/es/')) {
      itemLang = 'es';
    }
    
    if (itemLang !== currentLang) {
      item.style.display = 'none';
    }
  });
})();
</script>

