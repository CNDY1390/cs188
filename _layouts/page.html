---
layout: default
---

{% include language_toggle.html %}

{%- comment -%} Get children_nav content and render it as markdown {%- endcomment -%}
{%- capture children_content -%}
{%- include components/children_nav.html -%}
{%- endcapture -%}
{%- if children_content != "" -%}
  {%- comment -%} Remove any script tags that might have been included {%- endcomment -%}
  {%- if children_content contains "<script>" -%}
    {%- assign script_parts = children_content | split: "<script>" -%}
    {%- assign children_content_clean = script_parts[0] -%}
    {%- for part in script_parts offset:1 -%}
      {%- assign after_script = part | split: "</script>" -%}
      {%- if after_script.size > 1 -%}
        {%- assign children_content_clean = children_content_clean | append: after_script[1] -%}
      {%- endif -%}
    {%- endfor -%}
  {%- else -%}
    {%- assign children_content_clean = children_content -%}
  {%- endif -%}
  {%- assign children_markdown = children_content_clean | markdownify -%}
{%- else -%}
  {%- assign children_markdown = "" -%}
{%- endif -%}

{%- comment -%} Remove unrendered children_nav markdown and script tags from content if present {%- endcomment -%}
{%- assign content_clean = content -%}
{%- comment -%} Remove script tags from content {%- endcomment -%}
{%- if content_clean contains "<script>" -%}
  {%- assign script_parts = content_clean | split: "<script>" -%}
  {%- assign content_clean = script_parts[0] -%}
  {%- for part in script_parts offset:1 -%}
    {%- assign after_script = part | split: "</script>" -%}
    {%- if after_script.size > 1 -%}
      {%- assign content_clean = content_clean | append: after_script[1] -%}
    {%- endif -%}
  {%- endfor -%}
{%- endif -%}
{%- if content_clean contains "* * *" -%}
  {%- assign content_parts = content_clean | split: "* * *" -%}
  {%- if content_parts.size > 1 -%}
    {%- assign content_clean = content_parts[0] -%}
    {%- for part in content_parts offset:1 -%}
      {%- assign part_stripped = part | strip -%}
      {%- comment -%} Skip parts that look like unrendered children_nav markdown or contain JavaScript {%- endcomment -%}
      {%- unless part_stripped contains "## TABLE OF CONTENTS" or part_stripped contains "]({{" or part_stripped contains "](/cs188/" or part_stripped contains "*   [" or part_stripped contains "function filterChildrenNav" or part_stripped contains "getLangFromPath" -%}
        {%- assign content_clean = content_clean | append: "* * *" | append: part -%}
      {%- endunless -%}
    {%- endfor -%}
  {%- endif -%}
{%- endif -%}

{% capture content %} {{ content_clean }} {% endcapture %}
<div class="page">
  <nav class="content-nav nav-list js-toc" aria-label="In-page navigation">
    {%- assign full_content = content | append: children_markdown -%}
    {% include toc.html html=full_content sanitize=true item_class="nav-list-item"
    anchor_class="nav-list-link" h_min=1 h_max=3 %}
  </nav>
  <div class="content">{{ content }}{{ children_markdown }}</div>
  {%- if children_content != "" -%}
  <script>
  (function() {
    function getLangFromPath(path) {
      if (path.indexOf('/zh-cn/') !== -1) return 'zh-cn';
      if (path.indexOf('/es/') !== -1) return 'es';
      return 'en';
    }
    
    function filterChildrenNav() {
      var pathname = window.location.pathname;
      var currentLang = getLangFromPath(pathname);
      
      var hrElements = document.querySelectorAll('hr');
      var targetList = null;
      for (var i = 0; i < hrElements.length; i++) {
        var nextSibling = hrElements[i].nextElementSibling;
        while (nextSibling) {
          if (nextSibling.tagName === 'UL') {
            targetList = nextSibling;
            break;
          }
          nextSibling = nextSibling.nextElementSibling;
        }
        if (targetList) break;
      }
      
      if (!targetList) return;
      
      var links = targetList.querySelectorAll('a');
      for (var i = 0; i < links.length; i++) {
        var link = links[i];
        var href = link.getAttribute('href');
        if (!href) continue;
        
        var itemLang = getLangFromPath(href);
        if (itemLang !== currentLang) {
          var listItem = link.closest('li');
          if (listItem) {
            listItem.style.display = 'none';
          }
        }
      }
    }
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', filterChildrenNav);
    } else {
      setTimeout(filterChildrenNav, 100);
    }
  })();
  </script>
  {%- endif -%}
</div>
